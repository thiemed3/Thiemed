<?xml version="1.0" encoding="utf-8"?>
<odoo noupdate="1">
    <!--PLANTILLA DE CORREO PARA RECIBO DE NÃ“MINA
      ==========================================
      Esta plantilla se usa automÃ¡ticamente cuando se confirma una nÃ³mina.
      TambiÃ©n puede enviarse manualmente desde el listado de nÃ³minas.-->
    
    <record id="email_template_payslip" model="mail.template">
        <field name="name">Recibo de NÃ³mina - EnvÃ­o al Empleado</field>
        <field name="model_id" ref="hr_payroll.model_hr_payslip"/>
        <!-- Remitente: email de la empresa o usuario -->
        <field name="email_from">${(object.company_id.email or user.email or 'noreply@example.com') | safe}</field>
        <!-- Destinatario: email laboral del empleado o email personal -->
        <field name="email_to">${(object.employee_id.work_email or (object.employee_id.address_home_id and object.employee_id.address_home_id.email) or '') | safe}</field>
        <!-- Asunto del correo -->
        <field name="subject">Tu Recibo de Salario â€“ ${object.date_from and object.date_from.strftime('%B %Y') or object.name}</field>
        <!-- Cuerpo del correo en HTML -->
        <field name="body_html" type="html"><![CDATA[
            <div style="font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 20px; background-color: #f4f4f4;">
                <div style="max-width: 600px; margin: 0 auto; background-color: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <!-- Header -->
                    <div style="background-color: #00a09d; color: white; padding: 20px; text-align: center;">
                        <h2 style="margin: 0;">Recibo de Salario</h2>
                    </div>
                    <!-- Content -->
                    <div style="padding: 30px;">
                        <p style="font-size: 16px; color: #333;">Hola <strong>${object.employee_id.name}</strong>,</p>
                        <p style="font-size: 14px; color: #555; line-height: 1.6;">
                            Te enviamos tu recibo de salario correspondiente al perÃ­odo
                            <strong>${object.date_from and object.date_from.strftime('%d/%m/%Y') or ''}</strong> -
                            <strong>${object.date_to and object.date_to.strftime('%d/%m/%Y') or ''}</strong>.
                        </p>
                        <div style="background-color: #f8f9fa; border-left: 4px solid #00a09d; padding: 15px; margin: 20px 0; border-radius: 4px;">
                            <p style="margin: 0; font-size: 14px; color: #555;">
                                ðŸ“„ <strong>Documento:</strong> ${object.number or object.name}<br/>
                                ðŸ’° <strong>Neto a Pagar:</strong> ${'{:,.0f}'.format(object.net_wage).replace(',', '.')} CLP
                            </p>
                        </div>
                        <p style="font-size: 14px; color: #555; line-height: 1.6;">
                            Puedes revisar el documento adjunto a este correo o acceder directamente
                            a la aplicaciÃ³n <strong>Documentos</strong> en Odoo para consultarlo en cualquier momento.
                        </p>
                        <p style="font-size: 13px; color: #888; margin-top: 30px;">
                            Si tienes alguna consulta sobre tu nÃ³mina, no dudes en contactar al departamento de Recursos Humanos.
                        </p>
                    </div>
                    <!-- Footer -->
                    <div style="background-color: #f8f9fa; padding: 20px; text-align: center; border-top: 1px solid #e9ecef;">
                        <p style="margin: 0; font-size: 13px; color: #6c757d;">
                            Saludos cordiales,<br/>
                            <strong>${object.company_id.name}</strong>
                        </p>
                        % if object.company_id.website:
                        <p style="margin: 10px 0 0 0; font-size: 12px;">
                            <a href="${object.company_id.website}" style="color: #00a09d; text-decoration: none;">
                                ${object.company_id.website}
                            </a>
                        </p>
                        % endif
                    </div>
                </div>
                <!-- Disclaimer -->
                <div style="max-width: 600px; margin: 20px auto; text-align: center;">
                    <p style="font-size: 11px; color: #999; line-height: 1.4;">
                        Este correo es automÃ¡tico. Por favor, no respondas a este mensaje.<br/>
                        Este documento es confidencial y estÃ¡ destinado Ãºnicamente a ${object.employee_id.name}.
                    </p>
                </div>
            </div>
        ]]></field>
        <!-- Reporte PDF adjunto -->
        <field name="report_template" ref="hr_payroll.action_report_payslip"/>
        <!-- Nombre del archivo adjunto -->
        <field name="report_name">Recibo_${(object.number or object.name or 'NOMINA').replace('/', '_')}</field>
        <!-- No auto-eliminar el correo enviado (para auditorÃ­a) -->
        <field name="auto_delete" eval="False"/>
        <!-- Idioma del correo (se toma del empleado) -->
        <field name="lang">${object.employee_id.address_home_id.lang or 'es_CL'}</field>
    </record>
</odoo>
